version: '3.5'
services:
  oidc:
    networks:
      default:
        aliases:
          - oidc.${PUBLIC_ORIGIN:-nmro.local}

  apigateway:
    networks:
      default:
        aliases:
          - api.${PUBLIC_ORIGIN:-nmro.local}

  landing:
    environment:
      IdentityUrl: http://oidc.${PUBLIC_ORIGIN:-nmro.local}
      CallBackUrl: http://${PUBLIC_ORIGIN:-nmro.local}

  health:
    environment:
      IdentityUrl: http://oidc.${PUBLIC_ORIGIN:-nmro.local}
      HealthChecksUI__Webhooks__Uri: "https://${LS_NOTIFY_HOOK}"

  iam-api:
    environment:
      - ConnectionStrings__DefaultConnection=${DB_POSTGRES:-Server=db-postgres;port=5432;Database=iam_db;UserId=nmro_dbadmin;Password=theForest&;Pooling=true}

networks:
  default:
    name: nmro-network
    driver: bridge
